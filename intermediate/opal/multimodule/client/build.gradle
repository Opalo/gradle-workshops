import org.apache.tools.ant.filters.ReplaceTokens

httpPort = 8080
stopPort = 8081
stopKey = 'stop'

repositories {
    mavenRepo(name: 'JQuery', url: 'http://code.jquery.com') {
        pattern = '[module]-[revision](.[classifier]).[ext]'
    }//TODO
}

configurations {
    jquery
}

dependencies {
    jquery group: 'jquery', name: 'jquery', version: '2.+', classifier: 'min', ext: 'js'
}

task fetchJQuery(type: Copy) {
    from configurations.jquery
    into 'src/main/webapp/js'
    rename {
        'jquery.js'
    }
}

tasks.idea.dependsOn(fetchJQuery)

war {

    def fonts = ['eot', 'svg', 'ttf', 'woff']
    def profile = project.properties['profile'] ? project.profile : 'local_int'

    eachFile {
        def extIdx = it.name.lastIndexOf('.')
        def ext
        if (extIdx > -1) {
            ext = it.name[(extIdx + 1)..-1]
        }
        if (!(ext in fonts)) {
            println "Filtering: $it in project: $project.name"
            it.filter(ReplaceTokens, tokens: profiles[profile])
        }
    }
}

