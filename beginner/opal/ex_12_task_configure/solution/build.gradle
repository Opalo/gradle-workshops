apply plugin: 'idea'
apply plugin: 'groovy'

repositories {
    mavenCentral()
}

dependencies {
    compile gradleApi()
    testCompile 'org.spockframework:spock-core:0.7-groovy-1.8'
}

// Specification
// Define task:
// - 'showOpenSourceLibs' that will print to standard output names of all tasks that are based on open source license
// - use 'allOpenSourceLibs' task collection within 'showOpenSourceLibs'

// Your solution goes below

def openSourceLicenses = ['LGPL', 'GPL', 'ASL', 'EPL']

tasks.withType(Zip).all { zip ->
    configure(zip) {
        license = null
        isOpenSource = {
            openSourceLicenses.contains(license)
        }
    }
}

task freeImages(type: Zip) {
    from 'img/free'
    license = 'GPL'
}

task royaltyImages(type: Zip) {
    from 'img/royalties'
    license = 'commercial'
}

task publicDocs(type: Zip) {
    from 'docs/public'
    license = 'LGPL'
}

task enterpriseDocs(type: Zip) {
    from 'docs/enterprise'
    license = 'commercial'
}

task eclipseLibs(type: Zip) {
    from 'libs/eclipse'
    license = 'EPL'
}

task oracleLibs(type: Zip) {
    from 'libs/oracle'
    license = 'commercial'
}

def allOpenSourceLibs = tasks.withType(Zip).matching { zip ->
    zip.isOpenSource()
}

task showOpenSourceLibs << {
    allOpenSourceLibs.each { println it }
}
